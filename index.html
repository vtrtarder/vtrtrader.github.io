<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DigitalGrove - Premium Digital Products</title>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    <style>
        /* Global Styles & Resets */
        :root {
            --primary-color: #6A11CB; /* Deep Purple */
            --secondary-color: #2575FC; /* Vibrant Blue */
            --accent-color: #FF6B6B; /* Coral for accents */
            --success-color: #4CAF50; /* Green for success */
            --text-dark: #1a202c;
            --text-light: #4a5568;
            --bg-light: #f7fafc;
            --bg-white: #ffffff;
            --border-color: #e2e8f0;
            --star-color: #ffc107; /* Yellow for stars */
            --shadow-sm: 0 1px 3px 0 rgba(0, 0, 0, 0.07), 0 1px 2px 0 rgba(0, 0, 0, 0.04);
            --shadow-md: 0 4px 6px -1px rgba(0, 0, 0, 0.08), 0 2px 4px -1px rgba(0, 0, 0, 0.05);
            --shadow-lg: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
            --border-radius: 0.75rem; /* 12px */
            --border-radius-sm: 0.5rem; /* 8px */
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Poppins', sans-serif;
            background-color: var(--bg-light);
            color: var(--text-dark);
            line-height: 1.6;
            overflow-x: hidden;
            transition: background-color 0.3s ease;
        }

        .container {
            width: 90%;
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 15px;
        }

        /* Utility Classes */
        .text-center { text-align: center; }
        .mb-1 { margin-bottom: 0.5rem; }
        .mb-2 { margin-bottom: 1rem; }
        .mb-3 { margin-bottom: 1.5rem; }
        .mb-4 { margin-bottom: 2rem; }
        .mt-1 { margin-top: 0.5rem; }
        .mt-2 { margin-top: 1rem; }
        .mt-3 { margin-top: 1.5rem; }
        .mt-4 { margin-top: 2rem; }
        .py-1 { padding-top: 0.5rem; padding-bottom: 0.5rem; }
        .py-2 { padding-top: 1rem; padding-bottom: 1rem; }
        .py-3 { padding-top: 1.5rem; padding-bottom: 1.5rem; }
        .py-4 { padding-top: 2rem; padding-bottom: 2rem; }
        .section { padding: 50px 0; } 
        .section-title {
            font-size: 2.25rem; 
            font-weight: 700;
            color: var(--text-dark);
            margin-bottom: 0.75rem;
            text-align: center;
        }
        .section-subtitle {
            font-size: 1.05rem; 
            color: var(--text-light);
            margin-bottom: 2.5rem;
            text-align: center;
            max-width: 600px;
            margin-left: auto;
            margin-right: auto;
        }

        /* Buttons */
        .btn {
            display: inline-block;
            padding: 0.65rem 1.3rem; 
            border-radius: var(--border-radius-sm); 
            font-weight: 600;
            text-decoration: none;
            transition: all 0.3s ease;
            cursor: pointer;
            border: none;
            font-size: 0.95rem; 
            text-align: center;
        }
        .btn-primary {
            background-image: linear-gradient(to right, var(--primary-color), var(--secondary-color));
            color: var(--bg-white);
            box-shadow: var(--shadow-sm);
        }
        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-md); 
            background-image: linear-gradient(to right, var(--secondary-color), var(--primary-color));
        }
        .btn-success { 
            background-color: var(--success-color);
            color: var(--bg-white);
            box-shadow: var(--shadow-sm);
        }
        .btn-success:hover {
            background-color: #45a049; 
            transform: translateY(-2px);
            box-shadow: var(--shadow-md);
        }
        .btn-outline {
            background-color: transparent;
            color: var(--primary-color);
            border: 2px solid var(--primary-color);
        }
        .btn-outline:hover {
            background-color: var(--primary-color);
            color: var(--bg-white);
        }
        .btn-accent { 
            background-color: var(--accent-color);
            color: var(--bg-white);
            border: 2px solid var(--accent-color);
        }
        .btn-accent:hover {
            background-color: #e65c5c; 
            border-color: #e65c5c;
            transform: translateY(-2px);
            box-shadow: var(--shadow-md);
        }
        .btn-light { /* For Back to Home button */
            background-color: var(--bg-light);
            color: var(--text-dark);
            border: 1px solid var(--border-color);
            box-shadow: var(--shadow-sm);
        }
        .btn-light:hover {
            background-color: var(--border-color);
            transform: translateY(-1px);
        }


        /* Header & Navbar */
        header {
            background-color: var(--bg-white);
            box-shadow: var(--shadow-md);
            position: sticky;
            top: 0;
            z-index: 1000;
            width: 100%;
        }
        .navbar {
            display: flex;
            justify-content: space-between;
            align-items: center;
            height: 70px; 
        }
        .nav-logo {
            font-size: 1.6rem; 
            font-weight: 800;
            color: var(--primary-color);
            text-decoration: none;
            display: flex;
            align-items: center;
        }
        .nav-logo svg {
            margin-right: 8px;
            width: 30px; 
            height: 30px;
        }
        .nav-links {
            list-style: none;
            display: flex;
        }
        .nav-links li {
            margin-left: 1.8rem; 
        }
        .nav-links a {
            text-decoration: none;
            color: var(--text-light);
            font-weight: 500;
            padding: 0.5rem 0;
            position: relative;
            transition: color 0.3s ease;
            font-size: 0.95rem;
        }
        .nav-links a::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 0;
            width: 0;
            height: 2px;
            background-color: var(--primary-color);
            transition: width 0.3s ease;
        }
        .nav-links a:hover, .nav-links a.active {
            color: var(--primary-color);
        }
        .nav-links a:hover::after, .nav-links a.active::after {
            width: 100%;
        }
        .nav-icons { display: flex; align-items: center; }
        .cart-icon-wrapper {
            position: relative;
            margin-right: 1rem; 
            cursor: pointer;
        }
        .cart-icon-wrapper svg {
            width: 26px; 
            height: 26px;
            color: var(--text-light);
            transition: color 0.3s ease;
        }
        .cart-icon-wrapper:hover svg { color: var(--primary-color); }
        .cart-item-count {
            position: absolute;
            top: -6px; 
            right: -8px; 
            background-color: var(--accent-color);
            color: white;
            border-radius: 50%;
            padding: 0.1rem 0.4rem; 
            font-size: 0.65rem; 
            font-weight: 700;
            border: 1.5px solid var(--bg-white);
        }
        .mobile-menu-icon {
            display: none; 
            cursor: pointer;
        }
        .mobile-menu-icon svg { width: 26px; height: 26px; color: var(--text-dark); }

        /* Main Content Area */
        main { min-height: calc(100vh - 70px - 100px); }
        .page-section { display: none; animation: fadeIn 0.5s ease-in-out; }
        .page-section.active { display: block; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

        /* Hero Section */
        .hero {
            background: linear-gradient(135deg, var(--primary-color) 0%, var(--secondary-color) 100%);
            color: white;
            padding: 80px 0; 
            text-align: center;
        }
        .hero h1 {
            font-size: 3rem; 
            font-weight: 800;
            margin-bottom: 0.75rem;
            line-height: 1.2;
        }
        .hero p {
            font-size: 1.15rem; 
            margin-bottom: 1.8rem;
            max-width: 700px;
            margin-left: auto;
            margin-right: auto;
            opacity: 0.9;
        }
        .hero .btn {
            padding: 0.9rem 1.8rem; 
            font-size: 1.05rem; 
            background: var(--bg-white);
            color: var(--primary-color);
        }
         .hero .btn:hover {
            background: var(--accent-color); 
            color: var(--bg-white);
        }

        /* Products Section - Updated Card Styles */
        .products-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(260px, 1fr)); 
            gap: 1.8rem; 
        }
        .product-card {
            background-color: var(--bg-white);
            border-radius: var(--border-radius-sm); 
            box-shadow: var(--shadow-sm); 
            overflow: hidden;
            transition: transform 0.3s ease, box-shadow 0.3s ease;
            display: flex;
            flex-direction: column;
        }
        .product-card:hover {
            transform: translateY(-4px); 
            box-shadow: var(--shadow-md); 
        }
        .product-image-container {
            width: 100%;
            padding-top: 100%; 
            position: relative;
            overflow: hidden;
            background-color: #f0f0f0; 
        }
        .product-image-container img {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            object-fit: cover;
            transition: transform 0.4s ease;
        }
        .product-card:hover .product-image-container img {
            transform: scale(1.03); 
        }
        
        .product-info {
            padding: 1rem; 
            flex-grow: 1;
            display: flex;
            flex-direction: column;
        }
        .product-info h3 { 
            font-size: 1rem; 
            font-weight: 500; 
            color: var(--text-dark);
            margin-bottom: 0.35rem;
            line-height: 1.4;
            height: 2.8em; 
            overflow: hidden;
            text-overflow: ellipsis;
            display: -webkit-box;
            -webkit-line-clamp: 2;
            -webkit-box-orient: vertical;
        }
        .product-seller-info { 
            font-size: 0.8rem;
            color: var(--text-light);
            margin-bottom: 0.35rem;
        }
        .product-rating {
            display: flex;
            align-items: center;
            margin-bottom: 0.5rem;
            font-size: 0.85rem;
            color: var(--text-light);
        }
        .product-rating .stars {
            color: var(--star-color);
            margin-right: 0.3rem;
            letter-spacing: 1px; 
        }
        .product-rating .reviews-count {
            margin-left: 0.2rem;
        }

        .product-price-container {
            margin-bottom: 0.75rem;
            line-height: 1.3;
        }
        .product-current-price {
            font-size: 1.25rem; 
            font-weight: 600;
            color: var(--text-dark); 
            margin-right: 0.5rem;
        }
        .product-original-price {
            font-size: 0.85rem;
            color: var(--text-light);
            text-decoration: line-through;
            margin-right: 0.5rem;
        }
        .product-discount {
            font-size: 0.85rem;
            color: var(--accent-color); 
            font-weight: 500;
        }
        .product-digital-tag {
            font-size: 0.8rem;
            color: var(--primary-color);
            font-weight: 500;
            margin-top: auto; 
            margin-bottom: 0.75rem;
        }
        .product-actions { 
            display: flex;
            gap: 0.5rem; 
        }
        .product-actions .btn {
            flex: 1; 
            padding: 0.6rem 0.5rem; 
            font-size: 0.85rem; 
        }


        /* Filters and Search */
        .products-page-header { /* Container for title, subtitle, and back button */
            display: flex;
            flex-direction: column;
            align-items: center;
            margin-bottom: 1.5rem; /* Space before filters */
        }
        .back-to-home-btn-container {
            width: 100%;
            display: flex;
            justify-content: flex-start; /* Align button to the left */
            margin-bottom: 1rem;
        }
        .back-to-home-btn {
            display: inline-flex; /* To align icon and text */
            align-items: center;
            gap: 0.5rem;
        }
        .back-to-home-btn svg {
            width: 18px;
            height: 18px;
        }

        .filters-container {
            display: flex;
            flex-wrap: wrap;
            gap: 1.5rem;
            margin-bottom: 2.5rem;
            padding: 1.5rem;
            background-color: var(--bg-white);
            border-radius: var(--border-radius);
            box-shadow: var(--shadow-sm);
        }
        .filter-group { flex: 1; min-width: 200px; }
        .filter-group label {
            display: block;
            font-weight: 500;
            margin-bottom: 0.5rem;
            color: var(--text-dark);
        }
        .filter-group input, .filter-group select {
            width: 100%;
            padding: 0.75rem;
            border: 1px solid var(--border-color);
            border-radius: 0.5rem; 
            font-size: 0.95rem;
            background-color: var(--bg-light);
        }
        .filter-group input:focus, .filter-group select:focus {
            outline: none;
            border-color: var(--primary-color);
            box-shadow: 0 0 0 2px rgba(106, 17, 203, 0.2);
        }

        /* About and Contact Pages */
        .content-section {
            background-color: var(--bg-white);
            padding: 2.5rem;
            border-radius: var(--border-radius);
            box-shadow: var(--shadow-md);
            max-width: 800px;
            margin: 0 auto;
        }
        .content-section h2 { margin-bottom: 1.5rem; font-size: 1.8rem; color: var(--primary-color); }
        .content-section p { margin-bottom: 1rem; line-height: 1.7; }
        .contact-form .form-group { margin-bottom: 1.5rem; }
        .contact-form label { display: block; margin-bottom: 0.5rem; font-weight: 500; }
        .contact-form input, .contact-form textarea {
            width: 100%;
            padding: 0.75rem;
            border: 1px solid var(--border-color);
            border-radius: 0.5rem;
            font-size: 1rem;
        }
        .contact-form input:focus, .contact-form textarea:focus {
            outline: none;
            border-color: var(--primary-color);
            box-shadow: 0 0 0 2px rgba(106, 17, 203, 0.2);
        }
        .contact-form textarea { resize: vertical; min-height: 120px; }

        /* Footer */
        footer {
            background-color: var(--text-dark);
            color: #a0aec0; 
            padding: 30px 0; 
            text-align: center;
        }
        .footer-content p { margin-bottom: 0.4rem; font-size: 0.9rem; }
        .footer-content a { color: var(--bg-white); text-decoration: none; font-weight: 500; }
        .footer-content a:hover { color: var(--secondary-color); }
        .social-links { margin-top: 0.8rem; }
        .social-links a {
            margin: 0 0.7rem;
            display: inline-block;
            transition: transform 0.3s ease;
        }
        .social-links a:hover { transform: scale(1.2); }
        .social-links svg { width: 22px; height: 22px; fill: #a0aec0; }
        .social-links a:hover svg { fill: var(--bg-white); }

        /* Modal Base Styles (for Cart and Payment) */
        .modal {
            display: none; 
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.6);
            z-index: 1001;
            justify-content: center;
            align-items: center;
            opacity: 0;
            transition: opacity 0.3s ease;
        }
        .modal.open { display: flex; opacity: 1; }
        .modal-content {
            background-color: var(--bg-white);
            padding: 1.8rem; 
            border-radius: var(--border-radius);
            width: 90%;
            max-height: 85vh; 
            overflow-y: auto;
            box-shadow: var(--shadow-lg);
            transform: scale(0.95);
            transition: transform 0.3s ease;
        }
        .modal.open .modal-content { transform: scale(1); }
        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1.2rem;
            padding-bottom: 0.8rem;
            border-bottom: 1px solid var(--border-color);
        }
        .modal-header h2 { font-size: 1.6rem; color: var(--text-dark); }
        .close-modal-btn { background: none; border: none; font-size: 1.8rem; cursor: pointer; color: var(--text-light); }
        .close-modal-btn:hover { color: var(--accent-color); }

        /* Cart Modal Specifics - ENHANCED */
        .cart-modal-content { 
            max-width: 600px; 
        }
        .cart-items-list { 
            margin-bottom: 1.5rem; 
            max-height: 45vh; 
            overflow-y: auto;
            padding-right: 0.5rem; 
        }
        .cart-item {
            display: flex;
            align-items: flex-start; 
            padding: 1rem 0;
            border-bottom: 1px solid var(--border-color);
            gap: 1rem; 
        }
        .cart-item:last-child { border-bottom: none; }
        .cart-item img {
            width: 80px; 
            height: 80px;
            object-fit: cover;
            border-radius: var(--border-radius-sm);
            flex-shrink: 0; 
        }
        .cart-item-details { 
            flex-grow: 1;
            display: flex;
            flex-direction: column;
        }
        .cart-item-details h4 { 
            font-size: 1.05rem; 
            font-weight: 600; 
            margin-bottom: 0.25rem; 
            color: var(--text-dark);
            line-height: 1.3;
        }
        .cart-item-unit-price { 
            font-size: 0.85rem;
            color: var(--text-light);
            margin-bottom: 0.5rem;
        }
        .cart-item-controls {
            display: flex;
            align-items: center;
            justify-content: space-between; 
            margin-top: 0.5rem;
        }
        .cart-item-quantity-wrapper {
            display: flex;
            align-items: center;
        }
        .cart-item-quantity-wrapper label {
            font-size: 0.85rem;
            margin-right: 0.5rem;
            color: var(--text-light);
        }
        .cart-item-quantity input {
            width: 50px; 
            text-align: center;
            padding: 0.35rem; 
            border: 1px solid var(--border-color);
            border-radius: var(--border-radius-sm);
            font-size: 0.95rem;
            margin: 0 0.25rem; 
        }
         .cart-item-subtotal { 
            font-weight: 600;
            font-size: 1rem;
            color: var(--primary-color);
            text-align: right; 
        }
        .remove-item-btn {
            background: none; 
            border: none; 
            color: var(--accent-color); 
            cursor: pointer; 
            font-size: 1.2rem; 
            padding: 0.25rem;
            line-height: 1; 
            margin-left: 1rem; 
        }
        .remove-item-btn:hover { 
            color: #d32f2f; 
        }
        .cart-summary { 
            margin-top: 1.5rem; 
            padding-top: 1.5rem;
            border-top: 1px solid var(--border-color);
        }
        .cart-summary p { 
            font-size: 1.25rem; 
            font-weight: 700; 
            margin-bottom: 1.2rem; 
            color: var(--text-dark);
            display: flex;
            justify-content: space-between;
        }
        .cart-summary p span:first-child { color: var(--text-light); font-weight: 500;}
        .empty-cart-message { 
            text-align: center; 
            padding: 2.5rem 1rem; 
            color: var(--text-light); 
            font-size: 1.1rem;
        }
        .empty-cart-message svg {
            width: 50px;
            height: 50px;
            margin: 0 auto 1rem auto;
            display: block;
            color: var(--border-color);
        }


        /* Payment Modal Specifics */
        .payment-modal-content { max-width: 500px; }
        .payment-form-container .form-group { margin-bottom: 1rem; }
        .payment-form-container label {
            display: block;
            font-size: 0.9rem;
            font-weight: 500;
            margin-bottom: 0.3rem;
            color: var(--text-dark);
        }
        .payment-form-container input[type="text"],
        .payment-form-container input[type="tel"] {
            width: 100%;
            padding: 0.65rem 0.75rem;
            border: 1px solid var(--border-color);
            border-radius: var(--border-radius-sm);
            font-size: 0.95rem;
        }
        .payment-form-container input:focus {
            outline: none;
            border-color: var(--primary-color);
            box-shadow: 0 0 0 2px rgba(106, 17, 203, 0.2);
        }
        .merchant-details {
            background-color: var(--bg-light);
            padding: 1rem;
            border-radius: var(--border-radius-sm);
            margin-bottom: 1rem;
            border: 1px dashed var(--primary-color);
        }
        .merchant-details p {
            font-size: 0.95rem;
            color: var(--text-dark);
            margin-bottom: 0.5rem;
        }
        .merchant-details p strong { font-weight: 600; }
        .payment-instruction {
            font-size: 0.85rem;
            color: var(--text-light);
            margin-top: 1rem;
            margin-bottom: 1.5rem;
            text-align: center;
            padding: 0.5rem;
            background-color: #f0f8ff; 
            border-radius: var(--border-radius-sm);
        }
        #paymentSubmissionMessage { font-size: 0.9rem; text-align: center; }


        /* Responsive Design */
        @media (max-width: 768px) {
            .nav-links {
                display: none;
                flex-direction: column;
                position: absolute;
                top: 70px; 
                left: 0;
                width: 100%;
                background-color: var(--bg-white);
                box-shadow: var(--shadow-md);
                padding: 1rem 0;
            }
            .nav-links.open { display: flex; }
            .nav-links li { margin: 0; width: 100%; }
            .nav-links a {
                display: block;
                padding: 0.9rem 1.5rem; 
                text-align: center;
                border-bottom: 1px solid var(--border-color);
            }
            .nav-links a::after { display: none; } 
            .nav-links li:last-child a { border-bottom: none; }
            .mobile-menu-icon { display: block; }

            .hero h1 { font-size: 2.2rem; }
            .hero p { font-size: 0.95rem; }
            .section-title { font-size: 1.8rem; }
            .section-subtitle { font-size: 0.95rem; }

            .filters-container { flex-direction: column; }
            .products-grid { grid-template-columns: repeat(auto-fit, minmax(240px, 1fr)); } 
            .product-actions { flex-direction: column; } 
            .product-actions .btn { margin-bottom: 0.5rem; }
            .product-actions .btn:last-child { margin-bottom: 0; }

            .cart-item { flex-direction: column; align-items: stretch; } 
            .cart-item img { width: 100%; height: auto; max-height: 150px; object-fit: contain; margin-bottom: 0.5rem;}
            .cart-item-controls { flex-direction: column; align-items: flex-start; gap: 0.5rem; }
            .cart-item-subtotal { text-align: left; margin-top: 0.5rem; }
            .remove-item-btn { align-self: flex-end; }
        }
        @media (max-width: 480px) {
            .products-grid { grid-template-columns: 1fr; } 
            .product-info h3 { font-size: 0.95rem; }
            .product-current-price { font-size: 1.1rem; }
            .modal-content { padding: 1.2rem; } 
            .modal-header h2 { font-size: 1.4rem; }
        }

    </style>
</head>
<body>

    <header>
        <div class="container navbar">
            <a href="#" class="nav-logo" data-page="Home">
                <svg viewBox="0 0 24 24" fill="currentColor"><path d="M12 2L2 7l10 5 10-5-10-5zM2 17l10 5 10-5M2 12l10 5 10-5"></path></svg>
                DigitalGrove
            </a>
            <nav>
                <ul class="nav-links" id="navLinks">
                    <li><a href="#" class="active" data-page="Home">Home</a></li>
                    <li><a href="#" data-page="Products">Products</a></li>
                    <li><a href="#" data-page="About">About Us</a></li>
                    <li><a href="#" data-page="Contact">Contact</a></li>
                </ul>
            </nav>
            <div class="nav-icons">
                <div class="cart-icon-wrapper" id="cartIconWrapper">
                    <svg viewBox="0 0 24 24" fill="currentColor"><path d="M7 18c-1.1 0-1.99.9-1.99 2S5.9 22 7 22s2-.9 2-2-.9-2-2-2zm10 0c-1.1 0-1.99.9-1.99 2S15.9 22 17 22s2-.9 2-2-.9-2-2-2zm-1.45-5c.75 0 1.41-.41 1.75-1.03l3.58-6.49A.996.996 0 0020.01 4H5.21l-.94-2H1v2h2l3.6 7.59-1.35 2.44C4.52 15.37 5.48 17 7 17h12v-2H7l1.1-2h7.45z"></path></svg>
                    <span class="cart-item-count" id="cartItemCount">0</span>
                </div>
                <div class="mobile-menu-icon" id="mobileMenuIcon">
                    <svg viewBox="0 0 24 24" fill="currentColor" id="menuIconSvg"><path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"></path></svg>
                    <svg viewBox="0 0 24 24" fill="currentColor" id="closeIconSvg" style="display:none;"><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"></path></svg>
                </div>
            </div>
        </div>
    </header>

    <main>
        <section id="Home" class="page-section active">
            <div class="hero">
                <div class="container">
                    <h1>Premium Digital Assets, Instantly.</h1>
                    <p>Discover high-quality ebooks, software, templates, and courses designed to elevate your creative and professional projects.</p>
                    <a href="#" class="btn" data-page="Products">Explore Products</a>
                </div>
            </div>
            <div class="container section">
                <h2 class="section-title">Featured Products</h2>
                <p class="section-subtitle">Handpicked selections to kickstart your next big project. Check out what's popular right now!</p>
                <div class="products-grid" id="featuredProductsGrid">
                    </div>
            </div>
        </section>

        <section id="Products" class="page-section">
            <div class="container section">
                <div class="products-page-header">
                    <div class="back-to-home-btn-container">
                        <button class="btn btn-light back-to-home-btn" data-page="Home">
                            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="15 18 9 12 15 6"></polyline></svg>
                            Back to Home
                        </button>
                    </div>
                    <h1 class="section-title">Our Digital Collection</h1>
                    <p class="section-subtitle">Browse through our extensive library of digital goods. Use the filters to find exactly what you need.</p>
                </div>
                <div class="filters-container">
                    <div class="filter-group">
                        <label for="searchInput">Search Products</label>
                        <input type="text" id="searchInput" placeholder="e.g., 'ebook', 'design tool'">
                    </div>
                    <div class="filter-group">
                        <label for="categoryFilter">Filter by Category</label>
                        <select id="categoryFilter">
                            <option value="all">All Categories</option>
                            </select>
                    </div>
                </div>
                <div class="products-grid" id="allProductsGrid">
                    </div>
            </div>
        </section>

        <section id="About" class="page-section">
            <div class="container section">
                <div class="content-section">
                    <h1 class="section-title">About DigitalGrove</h1>
                    <p class="section-subtitle">Learn more about our mission, vision, and the team behind your favorite digital assets.</p>
                    <h2>Our Story</h2>
                    <p>DigitalGrove was founded in 2024 with a simple mission: to provide creators, entrepreneurs, and learners with high-quality, accessible digital resources. We believe that the right tools and knowledge can unlock immense potential, and we're passionate about curating a collection that inspires innovation and growth.</p>
                    <h2>Our Vision</h2>
                    <p>We envision a world where everyone has the digital assets they need to bring their ideas to life. Whether you're a seasoned professional or just starting out, DigitalGrove aims to be your trusted partner in your creative and professional journey. We are committed to constantly expanding our offerings and ensuring a seamless experience for our users.</p>
                    <h2>Why Choose Us?</h2>
                    <ul>
                        <li><strong>Curated Quality:</strong> Every product is handpicked and vetted for quality and utility.</li>
                        <li><strong>Instant Access:</strong> Get your digital products immediately after purchase.</li>
                        <li><strong>Affordable Pricing:</strong> Premium assets without the premium price tag.</li>
                        <li><strong>Dedicated Support:</strong> We're here to help you every step of the way.</li>
                    </ul>
                </div>
            </div>
        </section>

        <section id="Contact" class="page-section">
            <div class="container section">
                 <div class="content-section">
                    <h1 class="section-title">Get In Touch</h1>
                    <p class="section-subtitle">Have questions, feedback, or a collaboration idea? We'd love to hear from you!</p>
                    <form class="contact-form" id="contactForm">
                        <div class="form-group">
                            <label for="contactName">Full Name</label>
                            <input type="text" id="contactName" name="name" required>
                        </div>
                        <div class="form-group">
                            <label for="contactEmail">Email Address</label>
                            <input type="email" id="contactEmail" name="email" required>
                        </div>
                        <div class="form-group">
                            <label for="contactSubject">Subject</label>
                            <input type="text" id="contactSubject" name="subject">
                        </div>
                        <div class="form-group">
                            <label for="contactMessage">Message</label>
                            <textarea id="contactMessage" name="message" rows="5" required></textarea>
                        </div>
                        <button type="submit" class="btn btn-primary">Send Message</button>
                    </form>
                    <div id="formSubmissionMessage" class="mt-2" style="display:none;"></div>
                </div>
            </div>
        </section>
    </main>

    <footer>
        <div class="container footer-content">
            <p>&copy; <span id="currentYear"></span> DigitalGrove. All rights reserved.</p>
            <p>Designed with ❤️ in Islamabad, Pakistan.</p>
            <div class="social-links">
                <a href="#" aria-label="Facebook"><svg viewBox="0 0 24 24" fill="currentColor"><path d="M22.675 0h-21.35c-0.732 0-1.325 0.593-1.325 1.325v21.351c0 0.731 0.593 1.324 1.325 1.324h11.495v-9.294h-3.128v-3.622h3.128v-2.671c0-3.1 1.893-4.788 4.659-4.788 1.325 0 2.463 0.099 2.795 0.143v3.24l-1.918 0.001c-1.504 0-1.795 0.715-1.795 1.763v2.088h3.587l-0.467 3.622h-3.12v9.293h6.116c0.73 0 1.323-0.593 1.323-1.325v-21.35c0-0.732-0.593-1.325-1.325-1.325z"></path></svg></a>
                <a href="#" aria-label="Twitter"><svg viewBox="0 0 24 24" fill="currentColor"><path d="M23.953 4.57a10 10 0 01-2.825.775 4.958 4.958 0 002.163-2.723c-.951.555-2.005.959-3.127 1.184a4.92 4.92 0 00-8.384 4.482C7.69 8.095 4.067 6.13 1.64 3.162a4.822 4.822 0 00-.666 2.475c0 1.71.87 3.213 2.188 4.096a4.904 4.904 0 01-2.228-.616v.06a4.923 4.923 0 003.946 4.827 4.996 4.996 0 01-2.212.085 4.936 4.936 0 004.604 3.417 9.867 9.867 0 01-6.102 2.105c-.39 0-.779-.023-1.17-.067a13.995 13.995 0 007.557 2.209c9.053 0 13.998-7.496 13.998-13.985 0-.21 0-.42-.015-.63A9.935 9.935 0 0024 4.59z"></path></svg></a>
                <a href="#" aria-label="Instagram"><svg viewBox="0 0 24 24" fill="currentColor"><path d="M12 2.163c3.204 0 3.584.012 4.85.07 3.252.148 4.771 1.691 4.919 4.919.058 1.265.069 1.645.069 4.849 0 3.205-.012 3.584-.069 4.849-.149 3.225-1.664 4.771-4.919 4.919-1.266.058-1.644.07-4.85.07-3.204 0-3.584-.012-4.849-.07-3.26-.149-4.771-1.699-4.919-4.92-.058-1.265-.07-1.644-.07-4.849 0-3.204.013-3.583.07-4.849.149-3.227 1.664-4.771 4.919-4.919 1.266-.057 1.645-.069 4.849-.069zm0-2.163c-3.259 0-3.667.014-4.947.072-4.358.2-6.78 2.618-6.98 6.98-.059 1.281-.073 1.689-.073 4.948 0 3.259.014 3.668.072 4.948.2 4.358 2.618 6.78 6.98 6.98 1.281.059 1.689.073 4.948.073 3.259 0 3.668-.014 4.948-.072 4.354-.2 6.782-2.618 6.979-6.98.059-1.28.073-1.689.073-4.948s-.014-3.667-.072-4.947c-.196-4.354-2.617-6.78-6.979-6.98-1.281-.059-1.69-.073-4.948-.073zm0 5.838c-3.403 0-6.162 2.759-6.162 6.162s2.759 6.163 6.162 6.163 6.162-2.759 6.162-6.163c0-3.403-2.759-6.162-6.162-6.162zm0 10.162c-2.209 0-4-1.79-4-4s1.791-4 4-4 4 1.791 4 4-1.791 4-4 4zm6.406-11.845c-.796 0-1.441.645-1.441 1.44s.645 1.44 1.441 1.44c.795 0 1.439-.645 1.439-1.44s-.644-1.44-1.439-1.44z"></path></svg></a>
            </div>
        </div>
    </footer>

    <div class="modal cart-modal" id="cartModal"> 
        <div class="modal-content cart-modal-content"> 
            <div class="modal-header"> 
                <h2>Your Cart</h2>
                <button class="close-modal-btn" id="closeCartBtn">&times;</button> 
            </div>
            <div class="cart-items-list" id="cartItemsList">
                 </div>
            <div class="cart-summary">
                <p><span>Subtotal:</span> <span id="cartSubtotal">PKR 0</span></p>
                <p><span>Total:</span> <span id="cartTotal">PKR 0</span></p>
                <button class="btn btn-primary" id="proceedToCheckoutBtn" style="width:100%;">Proceed to Checkout</button>
            </div>
        </div>
    </div>

    <div class="modal payment-modal" id="paymentModal"> 
        <div class="modal-content payment-modal-content"> 
            <div class="modal-header"> 
                <h2>Easy Paisa Payment</h2>
                <button class="close-modal-btn" id="closePaymentModalBtn">&times;</button> 
            </div>
            <div class="payment-form-container">
                <div class="merchant-details">
                    <p><strong>Pay To:</strong></p>
                    <p><strong>Holder Name:</strong> FAZAL JALEEL</p>
                    <p><strong>Account Number:</strong> 03174787683</p>
                    <p><strong>Total Amount:</strong> PKR <span id="paymentModalTotalAmount">0</span></p>
                </div>
                <hr style="margin: 1rem 0; border-color: var(--border-color);">
                <p style="font-size: 0.9rem; margin-bottom: 1rem; color: var(--text-dark);">Please enter your details after sending the payment:</p>
                <form id="easyPaisaForm" action="https://formspree.io/f/mrbqapyp" method="POST">
                    <div class="form-group">
                        <label for="customerName">Your Full Name:</label>
                        <input type="text" id="customerName" name="customerName" required>
                    </div>
                    <div class="form-group">
                        <label for="customerAccount">Your Easy Paisa Account Number (Sender):</label>
                        <input type="tel" id="customerAccount" name="customerAccount" required placeholder="e.g., 03xxxxxxxxx">
                    </div>
                    <div class="form-group">
                        <label for="whatsappNumber">Your WhatsApp Number:</label>
                        <input type="tel" id="whatsappNumber" name="whatsappNumber" required placeholder="e.g., 03xxxxxxxxx">
                    </div>
                     <div class="form-group">
                        <label for="transactionId">Transaction ID (TID) (Optional):</label>
                        <input type="text" id="transactionId" name="transactionId" placeholder="Optional, but helps verify faster">
                    </div>
                    <input type="hidden" name="cartDetails" id="formCartDetails">
                    <input type="hidden" name="totalOrderAmount" id="formTotalOrderAmount">
                    
                    <p class="payment-instruction">After making the payment to the above account, please fill this form and click "Confirm Order".</p>
                    <button type="submit" class="btn btn-success" style="width:100%;">Confirm Order</button>
                </form>
                <div id="paymentSubmissionMessage" class="mt-2" style="display:none; font-weight: 500;"></div>
            </div>
        </div>
    </div>


    <script>
        // Mock Product Data - Updated with PKR prices
        const products = [
            {
                id: 1,
                name: 'PT BOT FOR BINARY TRADING ONLY FOR OLYMP BROKER',
                category: 'software',
                price: 10000, 
                originalPrice: 15000, 
                rating: 4.5,
                reviews: 125,
                description: 'A comprehensive collection of UI kits, templates, and assets for modern web designers.',
                imageUrl: 'https://i.imghippo.com/files/VzS3613GtE.png',
                tags: ['ui kit', 'web design', 'figma', 'sketch', 'landing page']
            },
            {
                id: 2,
                name: 'Ebook: The Art of Digital Marketing 2025 Edition',
                category: 'Ebooks',
                price: 5600, 
                originalPrice: 8400, 
                rating: 4.8,
                reviews: 350,
                description: 'Master digital marketing strategies with this in-depth guide covering SEO, SEM, and social media.',
                imageUrl: 'https://placehold.co/600x600/2575FC/FFFFFF?text=Marketing+Ebook&font=Poppins',
                tags: ['ebook', 'marketing', 'seo', 'social media', '2025']
            },
            {
                id: 3,
                name: 'Ultimate Productivity Software Suite (Lifetime Deal)',
                category: 'Software',
                price: 22000, 
                originalPrice: 55000, 
                rating: 4.2,
                reviews: 88,
                description: 'Boost your productivity with our all-in-one software suite for task management and collaboration.',
                imageUrl: 'https://placehold.co/600x600/FF6B6B/333333?text=Productivity+Suite&font=Poppins',
                tags: ['software', 'productivity', 'tools', 'business', 'lifetime']
            },
            {
                id: 4,
                name: 'Photography Masterclass Course: From Zero to Hero',
                category: 'Courses',
                price: 13800, 
                originalPrice: 27000, 
                rating: 4.9,
                reviews: 1200,
                description: 'Learn professional photography techniques from industry experts. Suitable for all levels.',
                imageUrl: 'https://placehold.co/600x600/4CAF50/FFFFFF?text=Photo+Course&font=Poppins',
                tags: ['course', 'photography', 'learning', 'creative', 'masterclass']
            },
            {
                id: 5,
                name: 'Mobile App UI Kit (iOS & Android) - 200+ Screens',
                category: 'Templates',
                price: 10900, 
                originalPrice: 22000, 
                rating: 4.6,
                reviews: 210,
                description: 'High-quality mobile app UI kit with hundreds of screens and components for iOS and Android.',
                imageUrl: 'https://placehold.co/600x600/FFC107/333333?text=Mobile+UI+Kit&font=Poppins',
                tags: ['mobile ui', 'app design', 'ios', 'android', 'ui kit']
            },
            {
                id: 6,
                name: 'Coding Bootcamp Prep Course: Web Dev Fundamentals',
                category: 'Courses',
                price: 4500, 
                originalPrice: 14000, 
                rating: 4.3,
                reviews: 95,
                description: 'Get ready for intensive coding bootcamps with this foundational web development course.',
                imageUrl: 'https://placehold.co/600x600/9C27B0/FFFFFF?text=Coding+Prep&font=Poppins',
                tags: ['coding', 'web development', 'education', 'bootcamp']
            }
        ];

        let cart = [];

        document.addEventListener('DOMContentLoaded', () => {
            const navLinksElements = document.querySelectorAll('.nav-links a, .nav-logo, .hero .btn, .back-to-home-btn'); // Added .back-to-home-btn
            const pageSections = document.querySelectorAll('.page-section');
            const mobileMenuIcon = document.getElementById('mobileMenuIcon');
            const navLinksContainer = document.getElementById('navLinks');
            const menuIconSvg = document.getElementById('menuIconSvg');
            const closeIconSvg = document.getElementById('closeIconSvg');

            function setActivePage(pageId) {
                pageSections.forEach(section => {
                    section.classList.toggle('active', section.id === pageId);
                });
                // Update active state for main navbar links
                document.querySelectorAll('.nav-links a').forEach(link => {
                     link.classList.toggle('active', link.dataset.page === pageId);
                });

                if (navLinksContainer.classList.contains('open')) {
                    navLinksContainer.classList.remove('open');
                    menuIconSvg.style.display = 'block';
                    closeIconSvg.style.display = 'none';
                }
                window.scrollTo(0, 0); 
            }

            navLinksElements.forEach(link => {
                link.addEventListener('click', (e) => {
                    e.preventDefault();
                    const pageId = e.currentTarget.dataset.page;
                    if (pageId) {
                        setActivePage(pageId);
                    }
                });
            });

            mobileMenuIcon.addEventListener('click', () => {
                navLinksContainer.classList.toggle('open');
                const isOpen = navLinksContainer.classList.contains('open');
                menuIconSvg.style.display = isOpen ? 'none' : 'block';
                closeIconSvg.style.display = isOpen ? 'block' : 'none';
            });
            
            renderProducts(products.slice(0, 3), 'featuredProductsGrid'); 
            renderProducts(products, 'allProductsGrid');
            populateCategories();

            // Cart Modal Elements
            const cartIconWrapper = document.getElementById('cartIconWrapper');
            const cartModal = document.getElementById('cartModal');
            const closeCartBtn = document.getElementById('closeCartBtn');
            const proceedToCheckoutBtn = document.getElementById('proceedToCheckoutBtn');
            
            cartIconWrapper.addEventListener('click', () => cartModal.classList.add('open'));
            closeCartBtn.addEventListener('click', () => cartModal.classList.remove('open'));
            cartModal.addEventListener('click', (e) => { 
                if (e.target === cartModal) cartModal.classList.remove('open');
            });

            // Payment Modal Elements
            const paymentModal = document.getElementById('paymentModal');
            const closePaymentModalBtn = document.getElementById('closePaymentModalBtn');
            const easyPaisaForm = document.getElementById('easyPaisaForm');
            const paymentModalTotalAmountEl = document.getElementById('paymentModalTotalAmount');
            const formCartDetailsInput = document.getElementById('formCartDetails');
            const formTotalOrderAmountInput = document.getElementById('formTotalOrderAmount');

            function openPaymentModal() {
                 if(cart.length === 0) { 
                    alert("Your cart is empty.");
                    return;
                }
                const totalAmount = cart.reduce((sum, item) => sum + (item.price * item.quantity), 0);
                paymentModalTotalAmountEl.textContent = totalAmount.toFixed(0);
                
                let cartSummaryForEmail = "";
                cart.forEach(item => {
                    cartSummaryForEmail += `${item.name} (Qty: ${item.quantity}) - PKR ${item.price.toFixed(0)}\n`;
                });
                formCartDetailsInput.value = cartSummaryForEmail;
                formTotalOrderAmountInput.value = `PKR ${totalAmount.toFixed(0)}`;

                cartModal.classList.remove('open'); 
                paymentModal.classList.add('open'); 
            }

            proceedToCheckoutBtn.addEventListener('click', () => {
                if(cart.length === 0) {
                    alert("Your cart is empty. Please add some products to your cart before proceeding to checkout.");
                    return;
                }
                openPaymentModal();
            });

            closePaymentModalBtn.addEventListener('click', () => paymentModal.classList.remove('open'));
            paymentModal.addEventListener('click', (e) => {
                if (e.target === paymentModal) paymentModal.classList.remove('open');
            });

            easyPaisaForm.addEventListener('submit', async (e) => { 
                e.preventDefault();
                const formData = new FormData(easyPaisaForm);
                const paymentSubmissionMessageEl = document.getElementById('paymentSubmissionMessage');
                const customerName = formData.get('customerName'); 

                if (!formData.get('customerName') || !formData.get('customerAccount') || !formData.get('whatsappNumber')) {
                    paymentSubmissionMessageEl.textContent = 'Please fill in all required fields (Name, Account, WhatsApp).';
                    paymentSubmissionMessageEl.style.color = 'var(--accent-color)';
                    paymentSubmissionMessageEl.style.display = 'block';
                    return;
                }
                 if (!/^03\d{9}$/.test(formData.get('customerAccount')) || !/^03\d{9}$/.test(formData.get('whatsappNumber'))) {
                     paymentSubmissionMessageEl.textContent = 'Please enter valid 11-digit phone numbers starting with 03 for Account and WhatsApp.';
                     paymentSubmissionMessageEl.style.color = 'var(--accent-color)';
                     paymentSubmissionMessageEl.style.display = 'block';
                     return;
                }

                paymentSubmissionMessageEl.textContent = 'Processing your order...';
                paymentSubmissionMessageEl.style.color = 'var(--text-light)';
                paymentSubmissionMessageEl.style.display = 'block';
                
                try {
                    const response = await fetch(easyPaisaForm.action, { 
                        method: 'POST',
                        body: formData,
                        headers: { 
                            'Accept': 'application/json'
                        }
                    });

                    if (response.ok) {
                        console.log("Order data sent to Formspree.");
                        paymentSubmissionMessageEl.textContent = `Thank you, ${customerName}! Your order is confirmed. You will receive your digital product via WhatsApp within the next 5 minutes.`;
                        paymentSubmissionMessageEl.style.color = 'var(--success-color)';
                        
                        easyPaisaForm.reset();
                        cart = []; 
                        updateCartDisplay(); 

                        setTimeout(() => {
                            paymentModal.classList.remove('open');
                            paymentSubmissionMessageEl.style.display = 'none'; 
                        }, 6000); 
                    } else {
                        const errorData = await response.json();
                        paymentSubmissionMessageEl.textContent = `Error submitting order: ${errorData.error || 'Please try again.'}`;
                        paymentSubmissionMessageEl.style.color = 'var(--accent-color)';
                        console.error("Formspree error:", response.status, errorData);
                    }
                } catch (error) {
                    paymentSubmissionMessageEl.textContent = 'Could not submit your order. Please check your internet connection and try again.';
                    paymentSubmissionMessageEl.style.color = 'var(--accent-color)';
                    console.error("Fetch error:", error);
                }
                paymentSubmissionMessageEl.style.display = 'block';
            });


            const searchInput = document.getElementById('searchInput');
            const categoryFilter = document.getElementById('categoryFilter');
            searchInput.addEventListener('input', filterAndRenderProducts);
            categoryFilter.addEventListener('change', filterAndRenderProducts);

            const contactForm = document.getElementById('contactForm');
            contactForm.addEventListener('submit', handleContactForm);

            document.getElementById('currentYear').textContent = new Date().getFullYear();
             setActivePage('Home');
        });

        function renderStars(rating) {
            const fullStars = Math.floor(rating);
            const halfStar = rating % 1 >= 0.5 ? 1 : 0; 
            const emptyStars = 5 - fullStars - halfStar;
            return '★'.repeat(fullStars) + (halfStar ? '★' : '') + '☆'.repeat(emptyStars); 
        }
        
        function formatReviewCount(count) {
            if (count >= 1000) {
                return (count / 1000).toFixed(1) + 'k';
            }
            return count;
        }

        function renderProducts(productsToRender, gridId) {
            const grid = document.getElementById(gridId);
            if (!grid) return;
            grid.innerHTML = ''; 
            if (productsToRender.length === 0) {
                grid.innerHTML = '<p style="grid-column: 1 / -1; text-align: center; color: var(--text-light);">No products found matching your criteria.</p>';
                return;
            }
            productsToRender.forEach(product => {
                const card = document.createElement('div');
                card.className = 'product-card';

                let priceHTML = `<span class="product-current-price">PKR ${product.price.toFixed(0)}</span>`;
                if (product.originalPrice && product.originalPrice > product.price) {
                    const discount = Math.round(((product.originalPrice - product.price) / product.originalPrice) * 100);
                    priceHTML += `<del class="product-original-price">PKR ${product.originalPrice.toFixed(0)}</del>`;
                    if (discount > 0) {
                         priceHTML += `<span class="product-discount">(${discount}% off)</span>`;
                    }
                }
                
                const sellerInfo = product.category || 'Digital Good';

                card.innerHTML = `
                    <div class="product-image-container">
                        <img src="${product.imageUrl}" alt="${product.name}" onerror="this.onerror=null;this.src='https://placehold.co/600x600/CCCCCC/FFFFFF?text=Image+Not+Found&font=Poppins';">
                    </div>
                    <div class="product-info">
                        <h3>${product.name}</h3>
                        <p class="product-seller-info">Category: ${sellerInfo}</p>
                        <div class="product-rating">
                            <span class="stars">${renderStars(product.rating || 0)}</span>
                            <span class="reviews-count">(${formatReviewCount(product.reviews || 0)})</span>
                        </div>
                        <div class="product-price-container">
                            ${priceHTML}
                        </div>
                        <p class="product-digital-tag">Digital Download</p>
                        <div class="product-actions">
                            <button class="btn btn-outline add-to-cart-btn" data-id="${product.id}">Add to Cart</button>
                            <button class="btn btn-accent buy-now-btn" data-id="${product.id}">Buy Now</button>
                        </div>
                    </div>
                `;
                grid.appendChild(card);
            });

            document.querySelectorAll(`#${gridId} .add-to-cart-btn`).forEach(button => {
                button.addEventListener('click', (e) => {
                    const productId = parseInt(e.target.dataset.id);
                    addToCart(productId);
                });
            });
             document.querySelectorAll(`#${gridId} .buy-now-btn`).forEach(button => {
                button.addEventListener('click', (e) => {
                    const productId = parseInt(e.target.dataset.id);
                    handleBuyNow(productId);
                });
            });
        }
        
        function handleBuyNow(productId) {
            const productToAdd = products.find(p => p.id === productId);
            if (!productToAdd) return;

            const existingCartItem = cart.find(item => item.id === productId);
            if (existingCartItem) {
                existingCartItem.quantity++;
            } else {
                cart.push({ ...productToAdd, quantity: 1 });
            }
            updateCartDisplay(); 
            
            const paymentModal = document.getElementById('paymentModal');
            const paymentModalTotalAmountEl = document.getElementById('paymentModalTotalAmount');
            const formCartDetailsInput = document.getElementById('formCartDetails');
            const formTotalOrderAmountInput = document.getElementById('formTotalOrderAmount');

            const totalAmount = cart.reduce((sum, item) => sum + (item.price * item.quantity), 0);
            paymentModalTotalAmountEl.textContent = totalAmount.toFixed(0);
            
            let cartSummaryForEmail = "";
            cart.forEach(item => {
                cartSummaryForEmail += `${item.name} (Qty: ${item.quantity}) - PKR ${item.price.toFixed(0)}\n`;
            });
            formCartDetailsInput.value = cartSummaryForEmail;
            formTotalOrderAmountInput.value = `PKR ${totalAmount.toFixed(0)}`;
            
            paymentModal.classList.add('open');
        }


        function populateCategories() {
            const categories = [...new Set(products.map(p => p.category))]; 
            const categoryFilter = document.getElementById('categoryFilter');
            categories.forEach(category => {
                const option = document.createElement('option');
                option.value = category.toLowerCase();
                option.textContent = category;
                categoryFilter.appendChild(option);
            });
        }

        function filterAndRenderProducts() {
            const searchTerm = document.getElementById('searchInput').value.toLowerCase();
            const selectedCategory = document.getElementById('categoryFilter').value;

            let filtered = products.filter(product => {
                const nameMatch = product.name.toLowerCase().includes(searchTerm);
                const descMatch = product.description ? product.description.toLowerCase().includes(searchTerm) : false;
                const tagsMatch = product.tags ? product.tags.some(tag => tag.toLowerCase().includes(searchTerm)) : false;
                const categoryMatch = selectedCategory === 'all' || product.category.toLowerCase() === selectedCategory;
                return (nameMatch || descMatch || tagsMatch) && categoryMatch;
            });
            renderProducts(filtered, 'allProductsGrid');
        }

        function addToCart(productId) {
            const productToAdd = products.find(p => p.id === productId);
            if (!productToAdd) return;

            const existingCartItem = cart.find(item => item.id === productId);
            if (existingCartItem) {
                existingCartItem.quantity++;
            } else {
                cart.push({ ...productToAdd, quantity: 1 });
            }
            updateCartDisplay();
            showNotification(`${productToAdd.name} added to cart!`);
        }
        
        function updateCartQuantity(productId, newQuantity) {
            const cartItem = cart.find(item => item.id === productId);
            if (cartItem) {
                if (newQuantity <= 0) {
                    removeFromCart(productId); 
                } else {
                    cartItem.quantity = newQuantity;
                }
            }
            updateCartDisplay();
        }

        function removeFromCart(productId) {
            cart = cart.filter(item => item.id !== productId);
            updateCartDisplay();
        }

        function updateCartDisplay() {
            const cartItemsList = document.getElementById('cartItemsList');
            const cartSubtotalEl = document.getElementById('cartSubtotal'); 
            const cartTotalEl = document.getElementById('cartTotal');
            const cartItemCountEl = document.getElementById('cartItemCount');
            
            cartItemsList.innerHTML = ''; 

            if (cart.length === 0) {
                 cartItemsList.innerHTML = `
                    <div class="empty-cart-message">
                        <svg viewBox="0 0 24 24" fill="currentColor"><path d="M11 9h2V6h3V4h-3V1h-2v3H8v2h3v3zm-4 9c-1.1 0-1.99.9-1.99 2S5.9 22 7 22s2-.9 2-2-.9-2-2-2zm10 0c-1.1 0-1.99.9-1.99 2S15.9 22 17 22s2-.9 2-2-.9-2-2-2zm-9.83-3.25l.03-.12.9-1.63h7.45c.75 0 1.41-.41 1.75-1.03l3.86-7.01L19.42 4H5.21l-.94-2H1v2h2l3.6 7.59-1.35 2.44C4.52 15.37 5.48 17 7 17h12v-2H7l1.1-2-1.42-2.56z"></path></svg>
                        Your cart is currently empty.
                    </div>`;
            } else {
                cart.forEach(item => {
                    const itemEl = document.createElement('div');
                    itemEl.className = 'cart-item';
                    itemEl.innerHTML = `
                        <img src="${item.imageUrl}" alt="${item.name}" onerror="this.onerror=null;this.src='https://placehold.co/80x80/CCCCCC/FFFFFF?text=N/A&font=Poppins';">
                        <div class="cart-item-details">
                            <h4>${item.name}</h4>
                            <p class="cart-item-unit-price">PKR ${item.price.toFixed(0)}</p>
                            <div class="cart-item-controls">
                                <div class="cart-item-quantity-wrapper">
                                   <label for="qty-${item.id}">Qty:</label>
                                   <input type="number" class="cart-item-quantity" id="qty-${item.id}" value="${item.quantity}" min="1" data-id="${item.id}">
                                </div>
                                <p class="cart-item-subtotal">PKR ${(item.price * item.quantity).toFixed(0)}</p>
                            </div>
                        </div>
                        <button class="remove-item-btn" data-id="${item.id}" title="Remove item">&times;</button>
                    `;
                    cartItemsList.appendChild(itemEl);
                });
            }

            const total = cart.reduce((sum, item) => sum + (item.price * item.quantity), 0);
            if(cartSubtotalEl) cartSubtotalEl.textContent = `PKR ${total.toFixed(0)}`; 
            cartTotalEl.textContent = `PKR ${total.toFixed(0)}`; 
            cartItemCountEl.textContent = cart.reduce((sum, item) => sum + item.quantity, 0);
            
            document.querySelectorAll('.cart-item-quantity').forEach(input => {
                input.addEventListener('change', (e) => {
                    const productId = parseInt(e.target.dataset.id);
                    const newQuantity = parseInt(e.target.value);
                    updateCartQuantity(productId, newQuantity);
                });
                 input.addEventListener('input', (e) => { 
                    const productId = parseInt(e.target.dataset.id);
                    const newQuantity = parseInt(e.target.value);
                    if (newQuantity > 0) {
                        updateCartQuantity(productId, newQuantity);
                    } else if (e.target.value === "" || newQuantity <= 0) {
                         
                    }
                });
            });
            document.querySelectorAll('.remove-item-btn').forEach(button => {
                button.addEventListener('click', (e) => {
                    const productId = parseInt(e.target.dataset.id);
                    removeFromCart(productId);
                });
            });
        }
        
        function showNotification(message, duration = 3000) {
            const notification = document.createElement('div');
            notification.textContent = message;
            notification.style.position = 'fixed';
            notification.style.bottom = '20px';
            notification.style.right = '20px';
            notification.style.backgroundColor = 'var(--primary-color)';
            notification.style.color = 'white';
            notification.style.padding = '10px 20px';
            notification.style.borderRadius = 'var(--border-radius-sm)';
            notification.style.boxShadow = 'var(--shadow-lg)';
            notification.style.zIndex = '1002';
            notification.style.opacity = '0';
            notification.style.transition = 'opacity 0.3s ease, transform 0.3s ease';
            notification.style.transform = 'translateX(100%)';
            document.body.appendChild(notification);

            setTimeout(() => {
                notification.style.opacity = '1';
                notification.style.transform = 'translateX(0)';
            }, 10); 
            setTimeout(() => {
                notification.style.opacity = '0';
                notification.style.transform = 'translateX(100%)';
                setTimeout(() => notification.remove(), 300); 
            }, duration);
        }


        function handleContactForm(e) {
            e.preventDefault();
            const form = e.target;
            const name = form.name.value;
            const email = form.email.value;
            const message = form.message.value;
            const submissionMessageEl = document.getElementById('formSubmissionMessage');

            if (!name || !email || !message) {
                submissionMessageEl.textContent = 'Please fill in all required fields.';
                submissionMessageEl.style.color = 'var(--accent-color)';
                submissionMessageEl.style.display = 'block';
                return;
            }
            if (!/^\S+@\S+\.\S+$/.test(email)) {
                 submissionMessageEl.textContent = 'Please enter a valid email address.';
                submissionMessageEl.style.color = 'var(--accent-color)';
                submissionMessageEl.style.display = 'block';
                return;
            }

            console.log('Contact Form Submitted:', { name, email, subject: form.subject.value, message });
            submissionMessageEl.textContent = `Thank you, ${name}! Your message has been sent.`;
            submissionMessageEl.style.color = 'var(--success-color)'; 
            submissionMessageEl.style.display = 'block';
            form.reset();

            setTimeout(() => {
                submissionMessageEl.style.display = 'none';
            }, 5000); 
        }

    </script>
</body>
</html>